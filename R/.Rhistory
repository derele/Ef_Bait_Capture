                            if (myDF$length[i]<=500) { # If the sequence is smaller than 500bp, we cut it
                                j <- nrow(myDF)+1 # We fill at the end of the file
                                myDF[j,] <- myDF[i,] # Init.
                                myDF[j+1,] <- myDF[i,]
                                myDF[j+2,] <- myDF[i,]
                                myDF[j,4] <- myDF[j,5]-100 # First piece is 100 long, close to 1 bait
                                myDF[j,17] <- "0_to_100"
                                myDF[j+1,5] <- myDF[j,4]-1 # 2nd piece is 200 long, 100to300 from bait
                                myDF[j+1,4] <- myDF[j+1,5]-200
                                myDF[j+1,17] <- "100_to_300"
                                myDF[j+2,5] <- myDF[j+1,4]-1 # 3rd piece is 200 long, further away [300 to 500bp]
                                myDF[j+2,17] <- "300_to_500"
                                myDF[i,17] <- "To remove"
                            } else {
                                j <- nrow(myDF)+1 # We fill at the end of the file
                                myDF[j,] <- myDF[i,] # Init.
                                myDF[j+1,] <- myDF[i,]
                                myDF[j+2,] <- myDF[i,]
                                myDF[j+3,] <- myDF[i,]
                                myDF[j,4] <- myDF[j,5]-100 # First piece is 100 long, close to 1 bait
                                myDF[j,17] <- "0_to_100"
                                myDF[j+1,5] <- myDF[j,4]-1 # 2nd piece is 200 long, 100to300 from bait
                                myDF[j+1,4] <- myDF[j+1,5]-200
                                myDF[j+1,17] <- "100_to_300"
                                myDF[j+2,5] <- myDF[j+1,4]-1 # 3rd piece is 200 long, further away [300 to 500bp]
                                myDF[j+2,4] <- myDF[j+2,5]-200
                                myDF[j+2,17] <- "300_to_500"
                                myDF[j+3,5] <- myDF[j+2,4]-1 # 4th piece is further than 500bp from bait
                                myDF[j+3,17] <- "more_than_500"
                                myDF[i,17] <- "To remove"
                            }
                        }
                    }
                } else {
                                if (myDF$category[i]=="after") { #if the sequence is after a bait
                                    if (myDF$length[i]<=100) { # If the sequence is smaller than 100bp
                                        myDF$distance_to_bait[i]<-"0_to_100" # Any base is distant to max 100bp to a bait
                                    } else {
                                        if (myDF$length[i]<=300) { # If the sequence is smaller than 300bp, we cut it
                                            j <- nrow(myDF)+1 # We fill at the end of the file
                                            myDF[j,] <- myDF[i,] # New lines are created to split the sequence
                                            myDF[j+1,] <- myDF[i,]
                                            myDF[j,5] <- myDF[j,4]+100 # First piece is 100 long, close to 1 bait
                                            myDF[j,17] <- "0_to_100"
                                            myDF[j+1,4] <- myDF[j,5]+1 # Last piece is further from bait (100<d<300)
                                            myDF[j+1,17] <- "100_to_300"
                                            myDF[i,17] <- "To remove"
                                        } else {
                                            if (myDF$length[i]<=500) { # If the sequence is smaller than 500bp, we cut it
                                                j <- nrow(myDF)+1 # We fill at the end of the file
                                                myDF[j,] <- myDF[i,] # New lines are created to split the sequence
                                                myDF[j+1,] <- myDF[i,]
                                                myDF[j+2,] <- myDF[i,]
                                                myDF[j,5] <- myDF[j,4]+100 # First piece is 100 long, close to 1 bait
                                                myDF[j,17] <- "0_to_100"
                                                myDF[j+1,4] <- myDF[j,5]+1 # 2nd piece is further from bait (100<d<300)
                                                myDF[j+1,5] <- myDF[j+1,4]+200
                                                myDF[j+1,17] <- "100_to_300"
                                                myDF[j+2,4] <- myDF[j+1,5]+1 #3rd piece is between 300 and 500 from bait
                                                mDF[j+2,17] <- "300_to_500"
                                                myDF[i,17] <- "To remove"
                                            } else {
                                                j <- nrow(myDF)+1 # We fill at the end of the file
                                                myDF[j,] <- myDF[i,] # New lines are created to split the sequence
                                                myDF[j+1,] <- myDF[i,]
                                                myDF[j+2,] <- myDF[i,]
                                                myDF[j+3,] <- myDF[i,]
                                                myDF[j,5] <- myDF[j,4]+100 # First piece is 100 long, close to 1 bait
                                                myDF[j,17] <- "0_to_100"
                                                myDF[j+1,4] <- myDF[j,5]+1 # 2nd piece is further from bait (100<d<300)
                                                myDF[j+1,5] <- myDF[j+1,4]+200
myDF$distance_to_bait <- NA
for (i in 1:nrow(myDF)) {
    if (myDF$category[i]=="lonely") { # If the sequence is not on a contig with a bait, it's a "distant" sequence
        myDF$distance_to_bait[i] <- "distant"
    } else {
        if (myDF$category[i]=="BAIT") { # If the sequence is a bait, then... distance to bait is nulle
            myDF$distance_to_bait[i] <- "in_bait"
        } else {
            if (myDF$category[i]=="between") { # if the sequence is between 2 baits
                if (myDF$length[i]<=200) { # If the sequence is smaller than 200bp
                    myDF$distance_to_bait[i]<-"0_to_100" # Any base is distant to max 100bp to a bait
                } else {
                    if (myDF$length[i]<=600) { # If the sequence is smaller than 600bp, we cut it
                        j <- nrow(myDF)+1 # We fill at the end of the file
                        myDF[j,] <- myDF[i,] # New lines are created to split the sequence
                        myDF[j+1,] <- myDF[i,]
                        myDF[j+2,] <- myDF[i,]
                        myDF[j,5] <- myDF[j,4]+100 # First piece is 100 long, close to 1 bait
                        myDF[j,17] <- "0_to_100"
                        myDF[j+2,4] <- myDF[j+2,5]-100 # Last piece is 100 long, close to 1 bait
                        myDF[j+2,17] <- "0_to_100"
                        myDF[j+1,4] <- myDF[j,5]+1 # Last piece is further from bait (100<d<300)
                        myDF[j+1,5] <- myDF[j+2,4]-1
                        myDF[j+1,17] <- "100_to_300"
                        myDF[i,17] <- "To remove"
                    } else {
                        if (myDF$length[i]<=1000) { # If the sequence is smaller than 1000bp, we cut it
                            j <- nrow(myDF)+1 # We fill at the end of the file
                            myDF[j,] <- myDF[i,] # Init.
                            myDF[j+1,] <- myDF[i,]
                            myDF[j+2,] <- myDF[i,]
                            myDF[j+3,] <- myDF[i,]
                            myDF[j+4,] <- myDF[i,]
                            myDF[j,5] <- myDF[j,4]+100 # First piece is 100 long, close to 1 bait
                            myDF[j,17] <- "0_to_100"
                            myDF[j+4,4] <- myDF[j+4,5]-100 # Last piece is 100 long, close to 1 bait
                            myDF[j+4,17] <- "0_to_100"
                            myDF[j+1,4] <- myDF[j,5]+1
                            myDF[j+1,5] <- myDF[j+1,4]+200 # 2nd piece is 200 long, 100to300 from bait
                            myDF[j+1,17] <- "100_to_300"
                            myDF[j+3,5] <- myDF[j+4,4]-1
                            myDF[j+3,4] <- myDF[j+3,5]-200 # 4nd piece is 200 long, 100to300 from bait
                            myDF[j+3,17] <- "100_to_300"
                            myDF[j+2,4] <- myDF[j+1,5]+1
                            myDF[j+2,5] <- myDF[j+3,4]-1 # Middle piece is further away [300 to 500bp]
                            myDF[j+2,17] <- "300_to_500"
                            myDF[i,17] <- "To remove"
                        } else {
                            j <- nrow(myDF)+1 # We fill at the end of the file
                            myDF[j,] <- myDF[i,] # Init.
                            myDF[j+1,] <- myDF[i,]
                            myDF[j+2,] <- myDF[i,]
                            myDF[j+3,] <- myDF[i,]
                            myDF[j+4,] <- myDF[i,]
                            myDF[j+5,] <- myDF[i,]
                            myDF[j+6,] <- myDF[i,]
                            myDF[j,5] <- myDF[j,4]+100 # First piece is 100 long, close to 1 bait
                            myDF[j,17] <- "0_to_100"
                            myDF[j+6,4] <- myDF[j+6,5]-100 # Last piece is 100 long, close to 1 bait
                            myDF[j+6,17] <- "0_to_100"
                            myDF[j+1,4] <- myDF[j,5]+1
                            myDF[j+1,5] <- myDF[j+1,4]+200 # 2nd piece is 200 long, 100to300 from bait
                            myDF[j+1,17] <- "100_to_300"
                            myDF[j+5,5] <- myDF[j+6,4]-1
                            myDF[j+5,4] <- myDF[j+5,5]-200 # 6st piece is 200 long, 100to300 from bait
                            myDF[j+5,17] <- "100_to_300"
                            myDF[j+2,4] <- myDF[j+1,5]+1
                            myDF[j+2,5] <- myDF[j+2,4]+200 # 3rd piece is 200 long, 300to500 from bait
                            myDF[j+2,17] <- "300_to_500"
                            myDF[j+4,5] <- myDF[j+5,4]-1
                            myDF[j+4,4] <- myDF[j+4,5]-200 # 5th piece is 200 long, 300to500 from bait
                            myDF[j+4,17] <- "300_to_500"
                            myDF[j+3,4] <- myDF[j+2,5]+1 # Middle piece is further away [more than 500]
                            myDF[j+3,5] <- myDF[j+4,4]-1
                            myDF[j+3,17] <- "more_than_500"
                            myDF[i,17] <- "To remove"
                        }
                    }
                }
            } else {
                if (myDF$category[i]=="before") { # if the sequence is before a bait
                    if (myDF$length[i]<=100) { # If the sequence is smaller than 100bp
                        myDF$distance_to_bait[i]<-"0_to_100" # Any base is distant to max 100bp to a bait
                    } else {
                        if (myDF$length[i]<=300) { # If the sequence is smaller than 300bp, we cut it
                            j <- nrow(myDF)+1 # We fill at the end of the file
                            myDF[j,] <- myDF[i,] # New lines are created to split the sequence
                            myDF[j+1,] <- myDF[i,]
                            myDF[j,4] <- myDF[j,5]-100 # First piece is 100 long, close to 1 bait
                            myDF[j,17] <- "0_to_100"
                            myDF[j+1,5] <- myDF[j,4]-1 # Last piece is further from bait (100<d<300)
                            myDF[j+1,17] <- "100_to_300"
                            myDF[i,17] <- "To remove"
                        } else {
                            if (myDF$length[i]<=500) { # If the sequence is smaller than 500bp, we cut it
                                j <- nrow(myDF)+1 # We fill at the end of the file
                                myDF[j,] <- myDF[i,] # Init.
                                myDF[j+1,] <- myDF[i,]
                                myDF[j+2,] <- myDF[i,]
                                myDF[j,4] <- myDF[j,5]-100 # First piece is 100 long, close to 1 bait
                                myDF[j,17] <- "0_to_100"
                                myDF[j+1,5] <- myDF[j,4]-1 # 2nd piece is 200 long, 100to300 from bait
                                myDF[j+1,4] <- myDF[j+1,5]-200
                                myDF[j+1,17] <- "100_to_300"
                                myDF[j+2,5] <- myDF[j+1,4]-1 # 3rd piece is 200 long, further away [300 to 500bp]
                                myDF[j+2,17] <- "300_to_500"
                                myDF[i,17] <- "To remove"
                            } else {
                                j <- nrow(myDF)+1 # We fill at the end of the file
                                myDF[j,] <- myDF[i,] # Init.
                                myDF[j+1,] <- myDF[i,]
                                myDF[j+2,] <- myDF[i,]
                                myDF[j+3,] <- myDF[i,]
                                myDF[j,4] <- myDF[j,5]-100 # First piece is 100 long, close to 1 bait
                                myDF[j,17] <- "0_to_100"
                                myDF[j+1,5] <- myDF[j,4]-1 # 2nd piece is 200 long, 100to300 from bait
                                myDF[j+1,4] <- myDF[j+1,5]-200
                                myDF[j+1,17] <- "100_to_300"
                                myDF[j+2,5] <- myDF[j+1,4]-1 # 3rd piece is 200 long, further away [300 to 500bp]
                                myDF[j+2,4] <- myDF[j+2,5]-200
                                myDF[j+2,17] <- "300_to_500"
                                myDF[j+3,5] <- myDF[j+2,4]-1 # 4th piece is further than 500bp from bait
                                myDF[j+3,17] <- "more_than_500"
                                myDF[i,17] <- "To remove"
                            }
                        }
                    }
                } else {
                                if (myDF$category[i]=="after") { #if the sequence is after a bait
                                    if (myDF$length[i]<=100) { # If the sequence is smaller than 100bp
                                        myDF$distance_to_bait[i]<-"0_to_100" # Any base is distant to max 100bp to a bait
                                    } else {
                                        if (myDF$length[i]<=300) { # If the sequence is smaller than 300bp, we cut it
                                            j <- nrow(myDF)+1 # We fill at the end of the file
                                            myDF[j,] <- myDF[i,] # New lines are created to split the sequence
                                            myDF[j+1,] <- myDF[i,]
                                            myDF[j,5] <- myDF[j,4]+100 # First piece is 100 long, close to 1 bait
                                            myDF[j,17] <- "0_to_100"
                                            myDF[j+1,4] <- myDF[j,5]+1 # Last piece is further from bait (100<d<300)
                                            myDF[j+1,17] <- "100_to_300"
                                            myDF[i,17] <- "To remove"
                                        } else {
                                            if (myDF$length[i]<=500) { # If the sequence is smaller than 500bp, we cut it
                                                j <- nrow(myDF)+1 # We fill at the end of the file
                                                myDF[j,] <- myDF[i,] # New lines are created to split the sequence
                                                myDF[j+1,] <- myDF[i,]
                                                myDF[j+2,] <- myDF[i,]
                                                myDF[j,5] <- myDF[j,4]+100 # First piece is 100 long, close to 1 bait
                                                myDF[j,17] <- "0_to_100"
                                                myDF[j+1,4] <- myDF[j,5]+1 # 2nd piece is further from bait (100<d<300)
                                                myDF[j+1,5] <- myDF[j+1,4]+200
                                                myDF[j+1,17] <- "100_to_300"
                                                myDF[j+2,4] <- myDF[j+1,5]+1 #3rd piece is between 300 and 500 from bait
                                                mDF[j+2,17] <- "300_to_500"
                                                myDF[i,17] <- "To remove"
                                            } else {
                                                j <- nrow(myDF)+1 # We fill at the end of the file
                                                myDF[j,] <- myDF[i,] # New lines are created to split the sequence
                                                myDF[j+1,] <- myDF[i,]
                                                myDF[j+2,] <- myDF[i,]
                                                myDF[j+3,] <- myDF[i,]
                                                myDF[j,5] <- myDF[j,4]+100 # First piece is 100 long, close to 1 bait
                                                myDF[j,17] <- "0_to_100"
                                                myDF[j+1,4] <- myDF[j,5]+1 # 2nd piece is further from bait (100<d<300)
                                                myDF[j+1,5] <- myDF[j+1,4]+200
                                                myDF[j+1,17] <- "100_to_300"
                                                myDF[j+2,4] <- myDF[j+1,5]+1 #3rd piece is between 300 and 500 from bait
                                                myDF[j+2,5] <- myDF[j+2,4]+200                                     
                                                mDF[j+2,17] <- "300_to_500"
                                                myDF[j+3,4] <- myDF[j+2,4]+1 # 4th piece is further away (more than 500)
                                                myDF[j+3,17] <- "more_than_500"
                                                myDF[i,17] <- "To remove"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}
essai <- head(GTFordered, 50)
myDF <- essai
myDF$category <- NA
myDF$length <- myDF$V5 - myDF$V4 +1
if (str_split_fixed(myDF$V13, "_", 3)[1,1]=="Off")  # Is it an "Off"?
    {
        if (myDF[1,1]!=myDF[2,1])
        {
            myDF$category[1] <- "lonely"
        }
}    
for (i in 2:nrow(myDF)) {
    if (str_split_fixed(myDF$V13, "_", 3)[i,1]=="Off")  # Is it an "Off"?
    {if (myDF[i,1]!=myDF[i-1,1] & myDF[i,1]!=myDF[i+1,1]) # Is it a seq without baits?
        {myDF$category[i] <- "lonely"}
        else
        {if (myDF[i,1]==myDF[i-1,1] & myDF[i,1]==myDF[i+1,1]) # Is it a seq between 2 baits?
            {myDF$category[i] <- "between"}
            else
            {if (myDF[i,1]==myDF[i-1,1]) # Is it a seq AFTER a bait?
                {myDF$category[i] <- "after"}
                else
                {if (myDF[i,1]==myDF[i+1,1]) # Is it a seq BEFORE a bait?
                    {myDF$category[i] <- "before"}
                }
            }
        }
    }
    else
    {myDF$category[i] <- "BAIT"}
}
myDF$distance_to_bait <- NA
for (i in 1:nrow(myDF)) {
    if (myDF$category[i]=="lonely") { # If the sequence is not on a contig with a bait, it's a "distant" sequence
        myDF$distance_to_bait[i] <- "distant"
    } else {
        if (myDF$category[i]=="BAIT") { # If the sequence is a bait, then... distance to bait is nulle
            myDF$distance_to_bait[i] <- "in_bait"
        } else {
            if (myDF$category[i]=="between") { # if the sequence is between 2 baits
                if (myDF$length[i]<=200) { # If the sequence is smaller than 200bp
                    myDF$distance_to_bait[i]<-"0_to_100" # Any base is distant to max 100bp to a bait
                } else {
                    if (myDF$length[i]<=600) { # If the sequence is smaller than 600bp, we cut it
                        j <- nrow(myDF)+1 # We fill at the end of the file
                        myDF[j,] <- myDF[i,] # New lines are created to split the sequence
                        myDF[j+1,] <- myDF[i,]
                        myDF[j+2,] <- myDF[i,]
                        myDF[j,5] <- myDF[j,4]+100 # First piece is 100 long, close to 1 bait
                        myDF[j,17] <- "0_to_100"
                        myDF[j+2,4] <- myDF[j+2,5]-100 # Last piece is 100 long, close to 1 bait
                        myDF[j+2,17] <- "0_to_100"
                        myDF[j+1,4] <- myDF[j,5]+1 # Last piece is further from bait (100<d<300)
                        myDF[j+1,5] <- myDF[j+2,4]-1
                        myDF[j+1,17] <- "100_to_300"
                        myDF[i,17] <- "To remove"
                    } else {
                        if (myDF$length[i]<=1000) { # If the sequence is smaller than 1000bp, we cut it
                            j <- nrow(myDF)+1 # We fill at the end of the file
                            myDF[j,] <- myDF[i,] # Init.
                            myDF[j+1,] <- myDF[i,]
                            myDF[j+2,] <- myDF[i,]
                            myDF[j+3,] <- myDF[i,]
                            myDF[j+4,] <- myDF[i,]
                            myDF[j,5] <- myDF[j,4]+100 # First piece is 100 long, close to 1 bait
                            myDF[j,17] <- "0_to_100"
                            myDF[j+4,4] <- myDF[j+4,5]-100 # Last piece is 100 long, close to 1 bait
                            myDF[j+4,17] <- "0_to_100"
                            myDF[j+1,4] <- myDF[j,5]+1
                            myDF[j+1,5] <- myDF[j+1,4]+200 # 2nd piece is 200 long, 100to300 from bait
                            myDF[j+1,17] <- "100_to_300"
                            myDF[j+3,5] <- myDF[j+4,4]-1
                            myDF[j+3,4] <- myDF[j+3,5]-200 # 4nd piece is 200 long, 100to300 from bait
                            myDF[j+3,17] <- "100_to_300"
                            myDF[j+2,4] <- myDF[j+1,5]+1
                            myDF[j+2,5] <- myDF[j+3,4]-1 # Middle piece is further away [300 to 500bp]
                            myDF[j+2,17] <- "300_to_500"
                            myDF[i,17] <- "To remove"
                        } else {
                            j <- nrow(myDF)+1 # We fill at the end of the file
                            myDF[j,] <- myDF[i,] # Init.
                            myDF[j+1,] <- myDF[i,]
                            myDF[j+2,] <- myDF[i,]
                            myDF[j+3,] <- myDF[i,]
                            myDF[j+4,] <- myDF[i,]
                            myDF[j+5,] <- myDF[i,]
                            myDF[j+6,] <- myDF[i,]
                            myDF[j,5] <- myDF[j,4]+100 # First piece is 100 long, close to 1 bait
                            myDF[j,17] <- "0_to_100"
                            myDF[j+6,4] <- myDF[j+6,5]-100 # Last piece is 100 long, close to 1 bait
                            myDF[j+6,17] <- "0_to_100"
                            myDF[j+1,4] <- myDF[j,5]+1
                            myDF[j+1,5] <- myDF[j+1,4]+200 # 2nd piece is 200 long, 100to300 from bait
                            myDF[j+1,17] <- "100_to_300"
                            myDF[j+5,5] <- myDF[j+6,4]-1
                            myDF[j+5,4] <- myDF[j+5,5]-200 # 6st piece is 200 long, 100to300 from bait
                            myDF[j+5,17] <- "100_to_300"
                            myDF[j+2,4] <- myDF[j+1,5]+1
                            myDF[j+2,5] <- myDF[j+2,4]+200 # 3rd piece is 200 long, 300to500 from bait
                            myDF[j+2,17] <- "300_to_500"
                            myDF[j+4,5] <- myDF[j+5,4]-1
                            myDF[j+4,4] <- myDF[j+4,5]-200 # 5th piece is 200 long, 300to500 from bait
                            myDF[j+4,17] <- "300_to_500"
                            myDF[j+3,4] <- myDF[j+2,5]+1 # Middle piece is further away [more than 500]
                            myDF[j+3,5] <- myDF[j+4,4]-1
                            myDF[j+3,17] <- "more_than_500"
                            myDF[i,17] <- "To remove"
                        }
                    }
                }
            } else {
                if (myDF$category[i]=="before") { # if the sequence is before a bait
                    if (myDF$length[i]<=100) { # If the sequence is smaller than 100bp
                        myDF$distance_to_bait[i]<-"0_to_100" # Any base is distant to max 100bp to a bait
                    } else {
                        if (myDF$length[i]<=300) { # If the sequence is smaller than 300bp, we cut it
                            j <- nrow(myDF)+1 # We fill at the end of the file
                            myDF[j,] <- myDF[i,] # New lines are created to split the sequence
                            myDF[j+1,] <- myDF[i,]
                            myDF[j,4] <- myDF[j,5]-100 # First piece is 100 long, close to 1 bait
                            myDF[j,17] <- "0_to_100"
                            myDF[j+1,5] <- myDF[j,4]-1 # Last piece is further from bait (100<d<300)
                            myDF[j+1,17] <- "100_to_300"
                            myDF[i,17] <- "To remove"
                        } else {
                            if (myDF$length[i]<=500) { # If the sequence is smaller than 500bp, we cut it
                                j <- nrow(myDF)+1 # We fill at the end of the file
                                myDF[j,] <- myDF[i,] # Init.
                                myDF[j+1,] <- myDF[i,]
                                myDF[j+2,] <- myDF[i,]
                                myDF[j,4] <- myDF[j,5]-100 # First piece is 100 long, close to 1 bait
                                myDF[j,17] <- "0_to_100"
                                myDF[j+1,5] <- myDF[j,4]-1 # 2nd piece is 200 long, 100to300 from bait
                                myDF[j+1,4] <- myDF[j+1,5]-200
                                myDF[j+1,17] <- "100_to_300"
                                myDF[j+2,5] <- myDF[j+1,4]-1 # 3rd piece is 200 long, further away [300 to 500bp]
                                myDF[j+2,17] <- "300_to_500"
                                myDF[i,17] <- "To remove"
                            } else {
                                j <- nrow(myDF)+1 # We fill at the end of the file
                                myDF[j,] <- myDF[i,] # Init.
                                myDF[j+1,] <- myDF[i,]
                                myDF[j+2,] <- myDF[i,]
                                myDF[j+3,] <- myDF[i,]
                                myDF[j,4] <- myDF[j,5]-100 # First piece is 100 long, close to 1 bait
                                myDF[j,17] <- "0_to_100"
                                myDF[j+1,5] <- myDF[j,4]-1 # 2nd piece is 200 long, 100to300 from bait
                                myDF[j+1,4] <- myDF[j+1,5]-200
                                myDF[j+1,17] <- "100_to_300"
                                myDF[j+2,5] <- myDF[j+1,4]-1 # 3rd piece is 200 long, further away [300 to 500bp]
                                myDF[j+2,4] <- myDF[j+2,5]-200
                                myDF[j+2,17] <- "300_to_500"
                                myDF[j+3,5] <- myDF[j+2,4]-1 # 4th piece is further than 500bp from bait
                                myDF[j+3,17] <- "more_than_500"
                                myDF[i,17] <- "To remove"
                            }
                        }
                    }
                } else {
                    if (myDF$category[i]=="after") { #if the sequence is after a bait
                        if (myDF$length[i]<=100) { # If the sequence is smaller than 100bp
                            myDF$distance_to_bait[i]<-"0_to_100" # Any base is distant to max 100bp to a bait
                        } else {
                            if (myDF$length[i]<=300) { # If the sequence is smaller than 300bp, we cut it
                                j <- nrow(myDF)+1 # We fill at the end of the file
                                myDF[j,] <- myDF[i,] # New lines are created to split the sequence
                                myDF[j+1,] <- myDF[i,]
                                myDF[j,5] <- myDF[j,4]+100 # First piece is 100 long, close to 1 bait
                                myDF[j,17] <- "0_to_100"
                                myDF[j+1,4] <- myDF[j,5]+1 # Last piece is further from bait (100<d<300)
                                myDF[j+1,17] <- "100_to_300"
                                myDF[i,17] <- "To remove"
                            } else {
                                if (myDF$length[i]<=500) { # If the sequence is smaller than 500bp, we cut it
                                    j <- nrow(myDF)+1 # We fill at the end of the file
                                    myDF[j,] <- myDF[i,] # New lines are created to split the sequence
                                    myDF[j+1,] <- myDF[i,]
                                    myDF[j+2,] <- myDF[i,]
                                    myDF[j,5] <- myDF[j,4]+100 # First piece is 100 long, close to 1 bait
                                    myDF[j,17] <- "0_to_100"
                                    myDF[j+1,4] <- myDF[j,5]+1 # 2nd piece is further from bait (100<d<300)
                                    myDF[j+1,5] <- myDF[j+1,4]+200
                                    myDF[j+1,17] <- "100_to_300"
                                    myDF[j+2,4] <- myDF[j+1,5]+1 #3rd piece is between 300 and 500 from bait
                                    mDF[j+2,17] <- "300_to_500"
                                    myDF[i,17] <- "To remove"
                                } else {
                                    j <- nrow(myDF)+1 # We fill at the end of the file
                                    myDF[j,] <- myDF[i,] # New lines are created to split the sequence
                                    myDF[j+1,] <- myDF[i,]
                                    myDF[j+2,] <- myDF[i,]
                                    myDF[j+3,] <- myDF[i,]
                                    myDF[j,5] <- myDF[j,4]+100 # First piece is 100 long, close to 1 bait
                                    myDF[j,17] <- "0_to_100"
                                    myDF[j+1,4] <- myDF[j,5]+1 # 2nd piece is further from bait (100<d<300)
                                    myDF[j+1,5] <- myDF[j+1,4]+200
                                    myDF[j+1,17] <- "100_to_300"
                                    myDF[j+2,4] <- myDF[j+1,5]+1 #3rd piece is between 300 and 500 from bait
                                    myDF[j+2,5] <- myDF[j+2,4]+200                                     
                                    mDF[j+2,17] <- "300_to_500"
                                    myDF[j+3,4] <- myDF[j+2,4]+1 # 4th piece is further away (more than 500)
                                    myDF[j+3,17] <- "more_than_500"
                                    myDF[i,17] <- "To remove"
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}
}
}
}
    }

myDF
tail(myDF)
head(myDF,50)
myDF
tail(myDF)
head(myDF,50)
head(myDF)
paste(myDF$V13, myDF$distance_to_bait, sep="_")
myDF
head(myDF)
tail(myDF)
tail(myDF)
myDF
tail(myDF,50)
headl(myDF,50)
head(myDF,50)
tail(myDF,70)
myDF
myDF
))))
}}}}}
}}}}}}}}}}}}
+     if (myDF$category[i]=="lonely") { # If the sequence is not on a contig with a bait, it's a "distant" sequence
        myDF$distance_to_bait[i] <- "distant"
    } else {
        if (myDF$category[i]=="BAIT") { # If the sequence is a bait, then... distance to bait is nulle
            myDF$distance_to_bait[i] <- "in_bait"
        } else {
            if (myDF$category[i]=="between") { # if the sequence is between 2 baits
                if (myDF$length[i]<=200) { # If the sequence is smaller than 200bp
                    myDF$distance_to_bait[i]<-"0_to_100" # Any base is distant to max 100bp to a bait
                } else {
                    if (myDF$length[i]<=600) { # If the sequence is smaller than 600bp, we cut it
                        j <- nrow(myDF)+1 # We fill at the end of the file
                        myDF[j,] <- myDF[i,] # New lines are created to split the sequence
                        myDF[j+1,] <- myDF[i,]
                        myDF[j+2,] <- myDF[i,]
                        myDF[j,5] <- myDF[j,4]+100 # First piece is 100 long, close to 1 bait
                        myDF[j,18] <- "0_to_100"
                        myDF$subcontig[j] <- 1
                        myDF[j+2,4] <- myDF[j+2,5]-100 # Last piece is 100 long, close to 1 bait
                        myDF[j+2,18] <- "0_to_100"
                        myDF$subcontig[j+2] <- 3
                        myDF[j+1,4] <- myDF[j,5]+1 # Last piece is further from bait (100<d<300)
                        myDF[j+1,5] <- myDF[j+2,4]-1
                        myDF[j+1,18] <- "100_to_300"
                        myDF$subcontig[j+1] <- 2
                        myDF[i,18] <- "To remove"
                    } else {
                        if (myDF$length[i]<=1000) { # If the sequence is smaller than 1000bp, we cut it
                            j <- nrow(myDF)+1 # We fill at the end of the file
                            myDF[j,] <- myDF[i,] # Init.
                            myDF[j+1,] <- myDF[i,]
                            myDF[j+2,] <- myDF[i,]
                            myDF[j+3,] <- myDF[i,]
                            myDF[j+4,] <- myDF[i,]
                            myDF[j,5] <- myDF[j,4]+100 # First piece is 100 long, close to 1 bait
                            myDF[j,18] <- "0_to_100"
                            myDF$subcontig[j] <- 1
                            myDF[j+4,4] <- myDF[j+4,5]-100 # Last piece is 100 long, close to 1 bait
                            myDF[j+4,18] <- "0_to_100"
                            myDF$subcontig[j+4] <- 5
                            myDF[j+1,4] <- myDF[j,5]+1
                            myDF[j+1,5] <- myDF[j+1,4]+200 # 2nd piece is 200 long, 100to300 from bait
                            myDF[j+1,18] <- "100_to_300"
                            myDF$subcontig[j+1] <- 2
                            myDF[j+3,5] <- myDF[j+4,4]-1
                            myDF[j+3,4] <- myDF[j+3,5]-200 # 4nd piece is 200 long, 100to300 from bait
                            myDF[j+3,18] <- "100_to_300"
                            myDF$subcontig[j+3] <- 4
                            myDF[j+2,4] <- myDF[j+1,5]+1
                            myDF[j+2,5] <- myDF[j+3,4]-1 # Middle piece is further away [300 to 500bp]
                            myDF[j+2,18] <- "300_to_500"
                            myDF$subcontig[j+2] <- 3
                            myDF[i,18] <- "To remove"
                        } else {
                            j <- nrow(myDF)+1 # We fill at the end of the file
                            myDF[j,] <- myDF[i,] # Init.
                            myDF[j+1,] <- myDF[i,]
                            myDF[j+2,] <- myDF[i,]
                            myDF[j+3,] <- myDF[i,]
                            myDF[j+4,] <- myDF[i,]
                            myDF[j+5,] <- myDF[i,]
                            myDF[j+6,] <- myDF[i,]
                            myDF[j,5] <- myDF[j,4]+100 # First piece is 100 long, close to 1 bait
                            myDF[j,18] <- "0_to_100"
                            myDF$subcontig[j] <- 1
                            myDF[j+6,4] <- myDF[j+6,5]-100 # Last piece is 100 long, close to 1 bait
                            myDF[j+6,18] <- "0_to_100"
                            myDF$subcontig[j+6] <- 7
                            myDF[j+1,4] <- myDF[j,5]+1
                            myDF[j+1,5] <- myDF[j+1,4]+200 # 2nd piece is 200 long, 100to300 from bait
                            myDF[j+1,18] <- "100_to_300"
                            myDF$subcontig[j+1] <- 2
                            myDF[j+5,5] <- myDF[j+6,4]-1
                            myDF[j+5,4] <- myDF[j+5,5]-200 # 6st piece is 200 long, 100to300 from bait
                            myDF[j+5,18] <- "100_to_300"
                            myDF$subcontig[j+5] <- 6
                            myDF[j+2,4] <- myDF[j+1,5]+1
                            myDF[j+2,5] <- myDF[j+2,4]+200 # 3rd piece is 200 long, 300to500 from bait
                            myDF[j+2,18] <- "300_to_500"
                            myDF$subcontig[j+2] <- 3
                            myDF[j+4,5] <- myDF[j+5,4]-1
                            myDF[j+4,4] <- myDF[j+4,5]-200 # 5th piece is 200 long, 300to500 from bait
                            myDF[j+4,18] <- "300_to_500"
                            myDF$subcontig[j+4] <-5 
                            myDF[j+3,4] <- myDF[j+2,5]+1 # Middle piece is further away [more than 500]
                            myDF[j+3,5] <- myDF[j+4,4]-1
                            myDF[j+3,18] <- "more_than_500"
                            myDF$subcontig[j+3] <- 4
                            myDF[i,18] <- "To remove"
                        }
                    }
                }
            } else {
                if (myDF$category[i]=="before") { # if the sequence is before a bait
                    if (myDF$length[i]<=100) { # If the sequence is smaller than 100bp
                        myDF$distance_to_bait[i]<-"0_to_100" # Any base is distant to max 100bp to a bait
                    } else {
                        if (myDF$length[i]<=300) { # If the sequence is smaller than 300bp, we cut it
                            j <- nrow(myDF)+1 # We fill at the end of the file
                            myDF[j,] <- myDF[i,] # New lines are created to split the sequence
                            myDF[j+1,] <- myDF[i,]
                            myDF[j,4] <- myDF[j,5]-100 # First piece is 100 long, close to 1 bait
                            myDF[j,18] <- "0_to_100"
                            myDF$subcontig[j] <- 2
                            myDF[j+1,5] <- myDF[j,4]-1 # Last piece is further from bait (100<d<300)
                            myDF[j+1,18] <- "100_to_300"
                            myDF$subcontig[j+1] <- 1
                            myDF[i,18] <- "To remove"
                        } else {
                            if (myDF$length[i]<=500) { # If the sequence is smaller than 500bp, we cut it
                                j <- nrow(myDF)+1 # We fill at the end of the file
                                myDF[j,] <- myDF[i,] # Init.
                                myDF[j+1,] <- myDF[i,]
                                myDF[j+2,] <- myDF[i,]
                                myDF[j,4] <- myDF[j,5]-100 # First piece is 100 long, close to 1 bait
                                myDF[j,18] <- "0_to_100"
                                myDF$subcontig[j] <- 3
                                myDF[j+1,5] <- myDF[j,4]-1 # 2nd piece is 200 long, 100to300 from bait
                                myDF[j+1,4] <- myDF[j+1,5]-200
                                myDF[j+1,18] <- "100_to_300"
                                myDF$subcontig[j+1] <- 2
                                myDF[j+2,5] <- myDF[j+1,4]-1 # 3rd piece is 200 long, further away [300 to 500bp]
                                myDF[j+2,18] <- "300_to_500"
                                myDF$subcontig[j+2] <- 1
                                myDF[i,18] <- "To remove"
                            } else {
                                j <- nrow(myDF)+1 # We fill at the end of the file
                                myDF[j,] <- myDF[i,] # Init.
                                myDF[j+1,] <- myDF[i,]
                                myDF[j+2,] <- myDF[i,]
                                myDF[j+3,] <- myDF[i,]
                                myDF[j,4] <- myDF[j,5]-100 # First piece is 100 long, close to 1 bait
                                myDF[j,18] <- "0_to_100"
                                myDF$subcontig[j] <- 4
                                myDF[j+1,5] <- myDF[j,4]-1 # 2nd piece is 200 long, 100to300 from bait
                                myDF[j+1,4] <- myDF[j+1,5]-200
                                myDF[j+1,18] <- "100_to_300"
                                myDF$subcontig[j+1] <- 3
                                myDF[j+2,5] <- myDF[j+1,4]-1 # 3rd piece is 200 long, further away [300 to 500bp]
                                myDF[j+2,4] <- myDF[j+2,5]-200
                                myDF[j+2,18] <- "300_to_500"
                                myDF$subcontig[j+2] <- 2
                                myDF[j+3,5] <- myDF[j+2,4]-1 # 4th piece is further than 500bp from bait
                                myDF[j+3,18] <- "more_than_500"
                                myDF$subcontig[j+3] <- 1
                                myDF[i,18] <- "To remove"
                            }
                        }
                    }
                } else {
                    if (myDF$category[i]=="after") { #if the sequence is after a bait
                        if (myDF$length[i]<=100) { # If the sequence is smaller than 100bp
                            myDF$distance_to_bait[i]<-"0_to_100" # Any base is distant to max 100bp to a bait
                        } else {
                            if (myDF$length[i]<=300) { # If the sequence is smaller than 300bp, we cut it
                                j <- nrow(myDF)+1 # We fill at the end of the file
                                myDF[j,] <- myDF[i,] # New lines are created to split the sequence
                                myDF[j+1,] <- myDF[i,]
                                myDF[j,5] <- myDF[j,4]+100 # First piece is 100 long, close to 1 bait
                                myDF[j,18] <- "0_to_100"
                                myDF$subcontig[j] <- 1
                                myDF[j+1,4] <- myDF[j,5]+1 # Last piece is further from bait (100<d<300)
                                myDF[j+1,18] <- "100_to_300"
                                myDF$subcontig[j+1] <- 2
                                myDF[i,18] <- "To remove"
                            } else {
                                if (myDF$length[i]<=500) { # If the sequence is smaller than 500bp, we cut it
                                    j <- nrow(myDF)+1 # We fill at the end of the file
                                    myDF[j,] <- myDF[i,] # New lines are created to split the sequence
                                    myDF[j+1,] <- myDF[i,]
                                    myDF[j+2,] <- myDF[i,]
                                    myDF[j,5] <- myDF[j,4]+100 # First piece is 100 long, close to 1 bait
                                    myDF[j,18] <- "0_to_100"
                                    myDF$subcontig[j] <- 1
                                    myDF[j+1,4] <- myDF[j,5]+1 # 2nd piece is further from bait (100<d<300)
                                    myDF[j+1,5] <- myDF[j+1,4]+200
                                    myDF[j+1,18] <- "100_to_300"
                                    myDF$subcontig[j+1] <- 2
                                    myDF[j+2,4] <- myDF[j+1,5]+1 #3rd piece is between 300 and 500 from bait
                                    myDF[j+2,18] <- "300_to_500"
                                    myDF$subcontig[j+2] <- 3
                                    myDF[i,18] <- "To remove"
                                } else {
                                    j <- nrow(myDF)+1 # We fill at the end of the file
                                    myDF[j,] <- myDF[i,] # New lines are created to split the sequence
                                    myDF[j+1,] <- myDF[i,]
                                    myDF[j+2,] <- myDF[i,]
                                    myDF[j+3,] <- myDF[i,]
                                    myDF[j,5] <- myDF[j,4]+100 # First piece is 100 long, close to 1 bait
                                    myDF[j,18] <- "0_to_100"
                                    myDF$subcontig[j] <- 1
                                    myDF[j+1,4] <- myDF[j,5]+1 # 2nd piece is further from bait (100<d<300)
                                    myDF[j+1,5] <- myDF[j+1,4]+200
                                    myDF[j+1,18] <- "100_to_300"
                                    myDF$subcontig[j+1] <- 2
                                    myDF[j+2,4] <- myDF[j+1,5]+1 #3rd piece is between 300 and 500 from bait
                                    myDF[j+2,5] <- myDF[j+2,4]+200                                     
                                    myDF[j+2,18] <- "300_to_500"
                                    myDF$subcontig[j+2] <- 3
                                    myDF[j+3,4] <- myDF[j+2,4]+1 # 4th piece is further away (more than 500)
                                    myDF[j+3,18] <- "more_than_500"
                                    myDF$subcontig[j+3] <- 4
                                    myDF[i,18] <- "To remove"
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}
myDFsave
head(myDFsave)
head(myDF)
tail(myDF)
nrow(myDF)
